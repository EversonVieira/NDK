@using NDK.UI.Components.Base
@using NDK.UI.Models
@typeparam TValue where TValue : NDKFinderOutput
@inherits BaseSelect<TValue>
@if (IsRendered)
{

    <div class="ndk-component ndk-select-container">
        <div class="ndk-select-container-controllers">
            <div class="ndk-select-selected-items">
                @if (SelectedValue is not null)
                {
                    <span class="ndk-select-selected-item" @onclick=@(() => OnRemoveItem(SelectedValue))>
                        <span class="ndk-select-selected-item-text">
                            @((MarkupString)GetText(SelectedValue)!)
                        </span>
                        <span class="ndk-select-remove-circle-badge">
                            <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" /></svg>
                        </span>
                    </span>
                }

            </div>
            <div class="ndk-select-input-container">
                <NDKInputText @onclick="() => ShowPopup = !ShowPopup"
                              Class="ndk-select-input" 
                              EventListener="EventListenerEnum.ONCHANGE" 
                              ValueChanged="OnFilter"></NDKInputText>
            </div>
        </div>

        @if (ShowPopup)
        {
            <div class="ndk-select-popup">

                @foreach (var item in VisibleSource!)
                {
                    <div class="ndk-select-popup-item" @onclick="@(() => OnSelect(item))">
                        @((MarkupString)GetText(item)!)
                    </div>
                }

            </div>
        }
    </div>
}




